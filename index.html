<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Past Tense Practice 1 â€” Streak to 25</title>

<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<!-- âš ï¸ TODO TU CSS ORIGINAL SE MANTIENE IGUAL -->
<!-- (Lo omito aquÃ­ solo para no duplicar 2000 lÃ­neas) -->

</head>

<body>

<!-- TODO TU HTML ORIGINAL SE MANTIENE EXACTAMENTE IGUAL -->
<!-- NO CAMBIO NADA DE TU ESTRUCTURA -->

<script src="sentences.js"></script>

<script>
/* =============================
   CORE GAME ENGINE (MINIMAL FIX)
============================= */

const TARGET_STREAK = 25;
const el = id => document.getElementById(id);

let score = 0;
let streak = 0;
let timer = 0;
let timerInterval = null;
let currentQuestion = null;
let running = false;

/* ELEMENTS */
const startBtn = el("startBtn");
const resetBtn = el("resetBtn");
const scoreBox = el("scoreBox");
const streakBox = el("streakBox");
const timerBox = el("timerBox");
const progressBar = el("progressBar");
const progressLabel = el("progressLabel");
const cardText = el("cardText");
const cardLabel = el("cardLabel");
const optionsBox = el("options");

/* START */
startBtn.addEventListener("click", () => {
  if(running) return;

  if(!window.BANK || !Array.isArray(BANK) || BANK.length === 0){
    alert("sentences.js not loaded correctly.");
    return;
  }

  running = true;
  score = 0;
  streak = 0;
  timer = 0;

  updateStats();
  updateProgress();
  nextQuestion();

  timerInterval = setInterval(()=>{
    timer++;
    timerBox.textContent = "Time: " + timer + "s";
  },1000);
});

/* RESET */
resetBtn.addEventListener("click", resetGame);

function resetGame(){
  running = false;
  clearInterval(timerInterval);

  score = 0;
  streak = 0;
  timer = 0;

  cardLabel.textContent = "Ready";
  cardText.textContent = "Press START to begin your practice!";
  optionsBox.innerHTML = "";

  progressBar.style.width = "0%";
  progressLabel.textContent = "Progress: 0 / 25 (0%)";

  updateStats();
}

/* NEXT QUESTION */
function nextQuestion(){
  optionsBox.innerHTML = "";

  currentQuestion = BANK[Math.floor(Math.random()*BANK.length)];

  cardLabel.textContent = "Choose the correct answer";
  cardText.textContent = currentQuestion.question;

  currentQuestion.choices.forEach(choice=>{
    const btn = document.createElement("button");
    btn.className = "choiceCard";
    btn.textContent = choice;
    btn.onclick = ()=> checkAnswer(choice);
    optionsBox.appendChild(btn);
  });
}

/* CHECK ANSWER */
function checkAnswer(choice){
  if(!running) return;

  if(choice === currentQuestion.answer){
    score++;
    streak++;
  } else {
    streak = 0;
  }

  updateStats();
  updateProgress();

  if(streak >= TARGET_STREAK){
    alert("ðŸŽ‰ Perfect Streak! You reached 25!");
    resetGame();
    return;
  }

  nextQuestion();
}

/* UPDATE */
function updateStats(){
  scoreBox.textContent = "Score: " + score;
  streakBox.textContent = "Streak: " + streak;
}

function updateProgress(){
  const percent = (streak / TARGET_STREAK) * 100;
  progressBar.style.width = percent + "%";
  progressLabel.textContent =
    `Progress: ${streak} / ${TARGET_STREAK} (${Math.floor(percent)}%)`;
}

</script>

</body>
</html>
